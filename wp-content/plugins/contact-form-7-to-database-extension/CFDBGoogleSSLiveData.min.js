function cfdbdata(site_url,form_name,user,password){var param_array=[];param_array.push("action=cfdb-login");param_array.push("username="+encodeURI(user));param_array.push("password="+encodeURI(password));param_array.push("cfdb-action=cfdb-export");param_array.push("enc=JSON");param_array.push("format=array");param_array.push("form="+encodeURI(form_name));var args=arg_slice(arguments,4);args=process_name_value_args(args);param_array=param_array.concat(args);return fetch_json_url(site_url,param_array)}function fetch_json_url(site_url,param_array){var url=site_url+"/wp-admin/admin-ajax.php";var payload=param_array.join("&");var response=UrlFetchApp.fetch(url,{method:"post",payload:payload});var content=response.getContentText();if(content.indexOf("<strong>ERROR")==0){return content}return JSON.parse(content)}function CF7ToDBData(site_url,form_name,search,user,password){if(search!=""){return cfdbdata(site_url,form_name,user,password,"search",search)}return cfdbdata(site_url,form_name,user,password)}function arg_slice(args,position){var array=[];if(args.length>position){for(var i=position;i<args.length;i++){array.push(args[i])}}return array}function process_name_value_args(array){var name_value_array=[];var flag=true;var name=null;for(var i=0;i<array.length;i++){if(flag){name=array[i]}else{name_value_array.push(encodeURI(name)+"="+encodeURI(array[i]))}flag=!flag}return name_value_array}